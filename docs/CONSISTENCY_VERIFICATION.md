# å‰åç«¯å’Œæ•°æ®åº“ä¸€è‡´æ€§éªŒè¯æŠ¥å‘Š

## ğŸ“‹ éªŒè¯èŒƒå›´

æœ¬æ¬¡éªŒè¯ç¡®ä¿å‰ç«¯ã€åç«¯å’Œæ•°æ®åº“åœ¨ä»¥ä¸‹æ–¹é¢ä¿æŒä¸€è‡´ï¼š
- APIæ¥å£å®šä¹‰
- æ•°æ®æ¨¡å‹ç»“æ„
- è®¤è¯å’Œæˆæƒæœºåˆ¶
- é”™è¯¯å¤„ç†æ ¼å¼
- ä¸šåŠ¡é€»è¾‘ä¸€è‡´æ€§

## âœ… ä¸€ã€APIæ¥å£ä¸€è‡´æ€§

### 1.1 è®¤è¯æ¥å£

| æ¥å£ | å‰ç«¯è°ƒç”¨ | åç«¯å®ç° | çŠ¶æ€ |
|------|---------|---------|------|
| `POST /api/auth/login` | `authAPI.login()` | `routes/auth.js` | âœ… |
| `POST /api/auth/register` | `authAPI.register()` | `routes/auth.js` | âœ… |
| `POST /api/auth/wechat` | `authAPI.wechatLogin()` | `routes/auth.js` | âœ… |
| `GET /api/auth/verify` | `authAPI.verify()` | `routes/auth.js` | âœ… |

**éªŒè¯ç»“æœ**ï¼šâœ… æ‰€æœ‰è®¤è¯æ¥å£å‰åç«¯ä¸€è‡´

### 1.2 è®¢å•æ¥å£

| æ¥å£ | å‰ç«¯è°ƒç”¨ | åç«¯å®ç° | çŠ¶æ€ |
|------|---------|---------|------|
| `GET /api/orders` | `ordersAPI.list()` | `routes/orders.js` | âœ… |
| `GET /api/orders/search` | `ordersAPI.search()` | `routes/orders.js` | âœ… |
| `GET /api/orders/:id` | `ordersAPI.get()` | `routes/orders.js` | âœ… |
| `POST /api/orders` | `ordersAPI.create()` | `routes/orders.js` | âœ… |
| `PUT /api/orders/:id` | `ordersAPI.update()` | `routes/orders.js` | âœ… |
| `DELETE /api/orders/:id` | `ordersAPI.delete()` | `routes/orders.js` | âœ… |
| `GET /api/orders/admin/list` | `ordersAPI.adminList()` | `routes/orders.js` | âœ… |
| `POST /api/orders/admin/import` | `ordersAPI.adminImport()` | `routes/orders.js` | âœ… |

**éªŒè¯ç»“æœ**ï¼šâœ… æ‰€æœ‰è®¢å•æ¥å£å‰åç«¯ä¸€è‡´

### 1.3 æ‰¹æ¬¡æ¥å£

| æ¥å£ | å‰ç«¯è°ƒç”¨ | åç«¯å®ç° | çŠ¶æ€ |
|------|---------|---------|------|
| `GET /api/batches` | `batchesAPI.list()` | `routes/batches.js` | âœ… |
| `GET /api/batches/:id` | `batchesAPI.get()` | `routes/batches.js` | âœ… |
| `POST /api/batches` | `batchesAPI.create()` | `routes/batches.js` | âœ… |
| `PUT /api/batches/:id` | `batchesAPI.update()` | `routes/batches.js` | âœ… |
| `DELETE /api/batches/:id` | `batchesAPI.delete()` | `routes/batches.js` | âœ… |

**éªŒè¯ç»“æœ**ï¼šâœ… æ‰€æœ‰æ‰¹æ¬¡æ¥å£å‰åç«¯ä¸€è‡´

### 1.4 æ¶ˆæ¯æ¥å£

| æ¥å£ | å‰ç«¯è°ƒç”¨ | åç«¯å®ç° | çŠ¶æ€ |
|------|---------|---------|------|
| `GET /api/messages/conversations` | `messagesAPI.getConversations()` | `routes/messages.js` | âœ… |
| `GET /api/messages/:userId` | `messagesAPI.getMessages()` | `routes/messages.js` | âœ… |
| `POST /api/messages` | `messagesAPI.send()` | `routes/messages.js` | âœ… |

**éªŒè¯ç»“æœ**ï¼šâœ… æ‰€æœ‰æ¶ˆæ¯æ¥å£å‰åç«¯ä¸€è‡´

### 1.5 å¯¼å‡ºæ¥å£

| æ¥å£ | å‰ç«¯è°ƒç”¨ | åç«¯å®ç° | çŠ¶æ€ |
|------|---------|---------|------|
| `GET /api/export/batch/:batchId` | `exportAPI.exportBatch()` | `routes/export.js` | âœ… |
| `GET /api/export/all` | `exportAPI.exportAll()` | `routes/export.js` | âœ… |

**éªŒè¯ç»“æœ**ï¼šâœ… æ‰€æœ‰å¯¼å‡ºæ¥å£å‰åç«¯ä¸€è‡´

## âœ… äºŒã€æ•°æ®æ¨¡å‹ä¸€è‡´æ€§

### 2.1 Useræ¨¡å‹

| å­—æ®µ | ç±»å‹ | å‰ç«¯ä½¿ç”¨ | åç«¯å®šä¹‰ | çŠ¶æ€ |
|------|------|---------|---------|------|
| `_id` | ObjectId | âœ… | âœ… | âœ… |
| `username` | String | âœ… | âœ… | âœ… |
| `email` | String | âœ… | âœ… | âœ… |
| `phone` | String | âœ… | âœ… | âœ… |
| `password` | String | âŒ | âœ… | âœ… |
| `openid` | String | âœ… | âœ… | âœ… |
| `nickname` | String | âœ… | âœ… | âœ… |
| `avatar` | String | âœ… | âœ… | âœ… |
| `role` | String | âœ… | âœ… | âœ… |
| `loginType` | String | âœ… | âœ… | âœ… |
| `createdAt` | Date | âœ… | âœ… | âœ… |
| `lastLoginAt` | Date | âœ… | âœ… | âœ… |

**éªŒè¯ç»“æœ**ï¼šâœ… Useræ¨¡å‹å‰åç«¯ä¸€è‡´

### 2.2 Orderæ¨¡å‹

| å­—æ®µ | ç±»å‹ | å‰ç«¯ä½¿ç”¨ | åç«¯å®šä¹‰ | çŠ¶æ€ |
|------|------|---------|---------|------|
| `_id` | ObjectId | âœ… | âœ… | âœ… |
| `orderNumber` | String | âœ… | âœ… | âœ… |
| `customerName` | String | âœ… | âœ… | âœ… |
| `batch` | ObjectId | âœ… | âœ… | âœ… |
| `batchName` | String | âœ… | âœ… | âœ… |
| `status` | String | âœ… | âœ… | âœ… |
| `logisticsInfo` | String | âœ… | âœ… | âœ… |
| `logisticsUpdateTime` | Date | âœ… | âœ… | âœ… |
| `userId` | ObjectId | âœ… | âœ… | âœ… |
| `createdBy` | String | âœ… | âœ… | âœ… |
| `createdAt` | Date | âœ… | âœ… | âœ… |
| `updatedAt` | Date | âœ… | âœ… | âœ… |

**éªŒè¯ç»“æœ**ï¼šâœ… Orderæ¨¡å‹å‰åç«¯ä¸€è‡´

### 2.3 Batchæ¨¡å‹

| å­—æ®µ | ç±»å‹ | å‰ç«¯ä½¿ç”¨ | åç«¯å®šä¹‰ | çŠ¶æ€ |
|------|------|---------|---------|------|
| `_id` | ObjectId | âœ… | âœ… | âœ… |
| `name` | String | âœ… | âœ… | âœ… |
| `period` | String | âœ… | âœ… | âœ… |
| `month` | Number | âœ… | âœ… | âœ… |
| `year` | Number | âœ… | âœ… | âœ… |
| `dispatchTime` | Date | âœ… | âœ… | âœ… |
| `orderCount` | Number | âœ… | âœ… | âœ… |
| `createdBy` | ObjectId | âœ… | âœ… | âœ… |
| `createdAt` | Date | âœ… | âœ… | âœ… |

**éªŒè¯ç»“æœ**ï¼šâœ… Batchæ¨¡å‹å‰åç«¯ä¸€è‡´

### 2.4 Messageæ¨¡å‹

| å­—æ®µ | ç±»å‹ | å‰ç«¯ä½¿ç”¨ | åç«¯å®šä¹‰ | çŠ¶æ€ |
|------|------|---------|---------|------|
| `_id` | ObjectId | âœ… | âœ… | âœ… |
| `from` | ObjectId | âœ… | âœ… | âœ… |
| `to` | ObjectId | âœ… | âœ… | âœ… |
| `content` | String | âœ… | âœ… | âœ… |
| `read` | Boolean | âœ… | âœ… | âœ… |
| `createdAt` | Date | âœ… | âœ… | âœ… |

**éªŒè¯ç»“æœ**ï¼šâœ… Messageæ¨¡å‹å‰åç«¯ä¸€è‡´

## âœ… ä¸‰ã€è®¤è¯å’Œæˆæƒä¸€è‡´æ€§

### 3.1 è§’è‰²å®šä¹‰

| è§’è‰² | å‰ç«¯æ£€æŸ¥ | åç«¯æ£€æŸ¥ | æ•°æ®åº“æšä¸¾ | çŠ¶æ€ |
|------|---------|---------|-----------|------|
| `user` | âœ… | âœ… | âœ… | âœ… |
| `admin` | âœ… | âœ… | âœ… | âœ… |
| `superadmin` | âœ… | âœ… | âœ… | âœ… |

**éªŒè¯ç»“æœ**ï¼šâœ… è§’è‰²å®šä¹‰å®Œå…¨ä¸€è‡´

### 3.2 è®¤è¯æœºåˆ¶

| åŠŸèƒ½ | å‰ç«¯å®ç° | åç«¯å®ç° | çŠ¶æ€ |
|------|---------|---------|------|
| JWT Tokenå­˜å‚¨ | localStorage | âœ… | âœ… |
| TokenéªŒè¯ | `authAPI.verify()` | `middleware/auth.js` | âœ… |
| ç™»å½•çŠ¶æ€ç®¡ç† | `AuthContext` | JWTéªŒè¯ | âœ… |
| è‡ªåŠ¨è·³è½¬ | æ ¹æ®roleè·³è½¬ | âœ… | âœ… |

**éªŒè¯ç»“æœ**ï¼šâœ… è®¤è¯æœºåˆ¶ä¸€è‡´

### 3.3 æƒé™æ§åˆ¶

| åŠŸèƒ½ | å‰ç«¯ä¿æŠ¤ | åç«¯ä¿æŠ¤ | çŠ¶æ€ |
|------|---------|---------|------|
| ç®¡ç†å‘˜è·¯ç”± | `ProtectedRoute requireAdmin` | `requireAdmin`ä¸­é—´ä»¶ | âœ… |
| ç”¨æˆ·æ•°æ®éš”ç¦» | æ ¹æ®userIdè¿‡æ»¤ | æ ¹æ®userIdè¿‡æ»¤ | âœ… |
| æœªç™»å½•è®¿é—® | `OptionalAuthRoute` | `optionalAuthenticate` | âœ… |

**éªŒè¯ç»“æœ**ï¼šâœ… æƒé™æ§åˆ¶ä¸€è‡´

## âœ… å››ã€é”™è¯¯å¤„ç†ä¸€è‡´æ€§

### 4.1 é”™è¯¯æ ¼å¼

**å‰ç«¯æœŸæœ›**ï¼š
```javascript
{
  error: "é”™è¯¯ä¿¡æ¯"
}
```

**åç«¯è¿”å›**ï¼š
```javascript
res.status(400).json({ error: 'é”™è¯¯ä¿¡æ¯' });
```

**éªŒè¯ç»“æœ**ï¼šâœ… é”™è¯¯æ ¼å¼ä¸€è‡´

### 4.2 HTTPçŠ¶æ€ç 

| åœºæ™¯ | å‰ç«¯å¤„ç† | åç«¯è¿”å› | çŠ¶æ€ |
|------|---------|---------|------|
| æˆåŠŸ | 200 | 200 | âœ… |
| æœªæˆæƒ | 401è·³è½¬ç™»å½• | 401 | âœ… |
| æƒé™ä¸è¶³ | 403è·³è½¬ç”¨æˆ·é¡µ | 403 | âœ… |
| èµ„æºä¸å­˜åœ¨ | 404æ˜¾ç¤ºé”™è¯¯ | 404 | âœ… |
| æœåŠ¡å™¨é”™è¯¯ | 500æ˜¾ç¤ºé”™è¯¯ | 500 | âœ… |

**éªŒè¯ç»“æœ**ï¼šâœ… HTTPçŠ¶æ€ç ä¸€è‡´

## âœ… äº”ã€ä¸šåŠ¡é€»è¾‘ä¸€è‡´æ€§

### 5.1 è®¢å•çŠ¶æ€

| çŠ¶æ€ | å‰ç«¯æ˜¾ç¤º | åç«¯å¤„ç† | æ•°æ®åº“å­˜å‚¨ | çŠ¶æ€ |
|------|---------|---------|-----------|------|
| `åœ¨è·¯ä¸Š` | âœ… | âœ… | âœ… | âœ… |
| `å·²ç­¾æ”¶` | âœ… | âœ… | âœ… | âœ… |
| `å·²å‘å‡º` | âœ… | âœ… | âœ… | âœ… |

**éªŒè¯ç»“æœ**ï¼šâœ… è®¢å•çŠ¶æ€ä¸€è‡´

### 5.2 æ‰¹æ¬¡ç”Ÿæˆè§„åˆ™

| è§„åˆ™ | å‰ç«¯ç†è§£ | åç«¯å®ç° | çŠ¶æ€ |
|------|---------|---------|------|
| ä¸Šæ—¬ï¼ˆ1-15æ—¥ï¼‰ | âœ… | âœ… | âœ… |
| ä¸‹æ—¬ï¼ˆ16-31æ—¥ï¼‰ | âœ… | âœ… | âœ… |
| æ ¼å¼ï¼šYYYYå¹´MMæœˆ | âœ… | âœ… | âœ… |

**éªŒè¯ç»“æœ**ï¼šâœ… æ‰¹æ¬¡ç”Ÿæˆè§„åˆ™ä¸€è‡´

### 5.3 æ•°æ®è¿‡æ»¤è§„åˆ™

| åœºæ™¯ | å‰ç«¯è¿‡æ»¤ | åç«¯è¿‡æ»¤ | çŠ¶æ€ |
|------|---------|---------|------|
| æ™®é€šç”¨æˆ·çœ‹è‡ªå·±çš„è®¢å• | âœ… | âœ… | âœ… |
| ç®¡ç†å‘˜çœ‹æ‰€æœ‰è®¢å• | âœ… | âœ… | âœ… |
| æœªç™»å½•ç”¨æˆ·çœ‹æ‰€æœ‰è®¢å• | âœ… | âœ… | âœ… |

**éªŒè¯ç»“æœ**ï¼šâœ… æ•°æ®è¿‡æ»¤è§„åˆ™ä¸€è‡´

## âœ… å…­ã€ç¯å¢ƒå˜é‡ä¸€è‡´æ€§

### 6.1 å‰ç«¯ç¯å¢ƒå˜é‡

| å˜é‡ | å¼€å‘ç¯å¢ƒ | ç”Ÿäº§ç¯å¢ƒ | çŠ¶æ€ |
|------|---------|---------|------|
| `REACT_APP_API_URL` | `http://localhost:5000/api` | `https://api.yourdomain.com/api` | âœ… |

### 6.2 åç«¯ç¯å¢ƒå˜é‡

| å˜é‡ | å¼€å‘ç¯å¢ƒ | ç”Ÿäº§ç¯å¢ƒ | çŠ¶æ€ |
|------|---------|---------|------|
| `PORT` | `5000` | `5000` | âœ… |
| `MONGODB_URI` | æœ¬åœ°/Atlas | Atlas | âœ… |
| `JWT_SECRET` | å¼€å‘å¯†é’¥ | ç”Ÿäº§å¯†é’¥ | âœ… |
| `NODE_ENV` | `development` | `production` | âœ… |
| `FRONTEND_URL` | `http://localhost:3000` | `https://your-username.github.io` | âœ… |

**éªŒè¯ç»“æœ**ï¼šâœ… ç¯å¢ƒå˜é‡é…ç½®åˆç†

## ğŸ“Š æ€»ä½“éªŒè¯ç»“æœ

| éªŒè¯é¡¹ | çŠ¶æ€ | è¯´æ˜ |
|--------|------|------|
| APIæ¥å£ä¸€è‡´æ€§ | âœ… | æ‰€æœ‰æ¥å£å‰åç«¯å®Œå…¨ä¸€è‡´ |
| æ•°æ®æ¨¡å‹ä¸€è‡´æ€§ | âœ… | æ‰€æœ‰æ¨¡å‹å­—æ®µå®Œå…¨ä¸€è‡´ |
| è®¤è¯æˆæƒä¸€è‡´æ€§ | âœ… | è§’è‰²å’Œæƒé™æ§åˆ¶ä¸€è‡´ |
| é”™è¯¯å¤„ç†ä¸€è‡´æ€§ | âœ… | é”™è¯¯æ ¼å¼å’ŒçŠ¶æ€ç ä¸€è‡´ |
| ä¸šåŠ¡é€»è¾‘ä¸€è‡´æ€§ | âœ… | ä¸šåŠ¡è§„åˆ™å®Œå…¨ä¸€è‡´ |
| ç¯å¢ƒå˜é‡ä¸€è‡´æ€§ | âœ… | ç¯å¢ƒé…ç½®åˆç† |

## âœ… ç»“è®º

**å‰åç«¯å’Œæ•°æ®åº“å®Œå…¨ä¸€è‡´ï¼Œå¯ä»¥å®‰å…¨éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚**

### ä¸€è‡´æ€§å¾—åˆ†ï¼š100% âœ…

æ‰€æœ‰å…³é”®ç»„ä»¶ï¼ˆAPIæ¥å£ã€æ•°æ®æ¨¡å‹ã€è®¤è¯æˆæƒã€é”™è¯¯å¤„ç†ã€ä¸šåŠ¡é€»è¾‘ï¼‰éƒ½ç»è¿‡éªŒè¯ï¼Œç¡®ä¿å‰åç«¯å’Œæ•°æ®åº“å®Œå…¨åŒæ­¥ã€‚

---

**éªŒè¯æ—¶é—´**ï¼š2026å¹´1æœˆ
**éªŒè¯äººå‘˜**ï¼šAI Assistant
**çŠ¶æ€**ï¼šâœ… é€šè¿‡
